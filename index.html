<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Media Hub — Movies · TV · Music</title>
  <style>
    :root{
      --bg:#0b0b0d;
      --card:#0f1720;
      --accent:#e50914;
      --muted:#9aa6b2;
      --radius:12px;
    }
    body{
      margin:0;
      font-family:sans-serif;
      background:var(--bg);
      color:white;
      overflow-x:hidden;
    }
    header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:1rem;
      background:rgba(0,0,0,0.6);
      position:sticky;
      top:0;
      z-index:10;
    }
    header h1{margin:0;font-size:1.5rem;color:var(--accent);}
    nav button{
      background:none;
      border:none;
      color:white;
      margin:0 .5rem;
      font-size:1rem;
      cursor:pointer;
    }
    nav button.active{color:var(--accent);font-weight:bold;}
    .section{padding:1rem;}
    .row{display:flex;overflow-x:auto;gap:.5rem;}
    .card{
      background:var(--card);
      border-radius:var(--radius);
      min-width:150px;
      flex-shrink:0;
      cursor:pointer;
      overflow:hidden;
    }
    .card img{width:100%;display:block;}
    .card h3{font-size:.9rem;margin:.5rem;}
    #detailsModal{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.8);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    #detailsModal .content{
      background:var(--card);
      padding:1rem;
      border-radius:var(--radius);
      max-width:600px;
      width:90%;
    }
    #detailsModal h2{margin-top:0;}
    .closeBtn{float:right;cursor:pointer;color:var(--accent);}
    #searchBar{margin:1rem;}
    #searchInput{width:80%;padding:.5rem;border-radius:var(--radius);border:none;}
    #categoryChips{display:flex;flex-wrap:wrap;gap:.5rem;margin:.5rem 1rem;}
    .chip{
      padding:.3rem .6rem;
      background:var(--card);
      border-radius:20px;
      cursor:pointer;
      font-size:.85rem;
    }
    .chip.active{background:var(--accent);}
  </style>
</head>
<body>
  <header>
    <h1>Media Hub</h1>
    <nav>
      <button id="tabMovies" class="active">Movies</button>
      <button id="tabTV">TV</button>
      <button id="tabMusic">Music</button>
    </nav>
  </header>

  <div id="homeView" class="section">
    <h2>Trending Movies</h2>
    <div id="trendingMovies" class="row"></div>
    <h2>Trending TV</h2>
    <div id="trendingTV" class="row"></div>
    <h2>Quick Picks</h2>
    <div id="quickRow" class="row"></div>
  </div>

  <div id="searchBar">
    <input id="searchInput" type="text" placeholder="Search movies or TV..." />
    <button id="clearSearch">Clear</button>
  </div>
  <div id="categoryChips"></div>
  <div id="mediaGrid" class="section row"></div>

  <div id="detailsModal">
    <div class="content">
      <span class="closeBtn">&times;</span>
      <h2 id="detailsTitle"></h2>
      <p id="detailsOverview"></p>
      <div id="detailsProviders"></div>
    </div>
  </div>

  <script>
    const API_KEY = "a63b70ca6288b339b0b556535449d1b9"; // replace with TMDB key
    const IMG = "https://image.tmdb.org/t/p/w500";

    let activeView = "movie";
    let currentCategory = "";
    let searchQuery = "";

    const CATEGORIES = {
      movie:[
        {name:"Popular", value:"popular"},
        {name:"Top Rated", value:"top_rated"},
        {name:"Upcoming", value:"upcoming"}
      ],
      tv:[
        {name:"Popular", value:"popular"},
        {name:"Top Rated", value:"top_rated"},
        {name:"On Air", value:"on_the_air"}
      ]
    };

    const trendingMoviesRow = document.getElementById("trendingMovies");
    const trendingTVRow = document.getElementById("trendingTV");
    const quickRow = document.getElementById("quickRow");
    const mediaGrid = document.getElementById("mediaGrid");
    const detailsModal = document.getElementById("detailsModal");
    const detailsTitle = document.getElementById("detailsTitle");
    const detailsOverview = document.getElementById("detailsOverview");
    const detailsProviders = document.getElementById("detailsProviders");

    async function fetchData(url){
      const res = await fetch(url);
      return res.json();
    }

    function renderRowSmall(container, list){
      container.innerHTML = "";
      list.forEach(item=>{
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${IMG+item.poster_path}" alt="">
          <h3>${item.title||item.name}</h3>
        `;
        card.onclick = ()=>openDetails(item);
        container.appendChild(card);
      });
    }

    async function loadHome(){
      const movieData = await fetchData(`https://api.themoviedb.org/3/trending/movie/week?api_key=${API_KEY}`);
      const tvData = await fetchData(`https://api.themoviedb.org/3/trending/tv/week?api_key=${API_KEY}`);
      const movieList = movieData.results.slice(0,10);
      const tvList = tvData.results.slice(0,10);
      renderRowSmall(trendingMoviesRow, movieList);
      renderRowSmall(trendingTVRow, tvList);
      renderRowSmall(quickRow, [...movieList.slice(0,4), ...tvList.slice(0,4)]);
    }

    async function loadMedia(){
      let url = "";
      if(searchQuery){
        url = `https://api.themoviedb.org/3/search/${activeView}?api_key=${API_KEY}&query=${encodeURIComponent(searchQuery)}`;
      } else {
        url = `https://api.themoviedb.org/3/${activeView}/${currentCategory}?api_key=${API_KEY}`;
      }
      const data = await fetchData(url);
      mediaGrid.innerHTML = "";
      data.results.forEach(item=>{
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${IMG+item.poster_path}" alt="">
          <h3>${item.title||item.name}</h3>
        `;
        card.onclick = ()=>openDetails(item);
        mediaGrid.appendChild(card);
      });
    }

    function renderCategoryChips(){
      const chips = document.getElementById("categoryChips");
      chips.innerHTML = "";
      CATEGORIES[activeView].forEach(cat=>{
        const chip = document.createElement("div");
        chip.className = "chip"+(cat.value===currentCategory?" active":"");
        chip.textContent = cat.name;
        chip.onclick = ()=>{
          currentCategory=cat.value;
          renderCategoryChips();
          loadMedia();
        };
        chips.appendChild(chip);
      });
    }

    function openDetails(item){
      detailsTitle.textContent = item.title||item.name;
      detailsOverview.textContent = item.overview||"";
      detailsProviders.innerHTML = `<p>More info coming soon…</p>`;
      detailsModal.style.display="flex";
    }

    document.querySelector(".closeBtn").onclick = ()=>detailsModal.style.display="none";
    window.onclick = e=>{if(e.target===detailsModal) detailsModal.style.display="none";};

    document.getElementById("tabMovies").onclick=()=>{
      activeView="movie";
      currentCategory=CATEGORIES.movie[0].value;
      setActiveTab("tabMovies");
      renderCategoryChips();
      loadMedia();
    };
    document.getElementById("tabTV").onclick=()=>{
      activeView="tv";
      currentCategory=CATEGORIES.tv[0].value;
      setActiveTab("tabTV");
      renderCategoryChips();
      loadMedia();
    };
    document.getElementById("tabMusic").onclick=()=>{
      alert("Music view coming soon!");
      setActiveTab("tabMusic");
    };

    function setActiveTab(id){
      document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    document.getElementById("searchInput").addEventListener("input",e=>{
      searchQuery=e.target.value;
      loadMedia();
    });
    document.getElementById("clearSearch").onclick=()=>{
      document.getElementById("searchInput").value="";
      searchQuery="";
      loadMedia();
    };

    // Init
    loadHome();
    currentCategory=CATEGORIES[activeView][0].value;
    renderCategoryChips();
    loadMedia();
  </script>
</body>
</html>